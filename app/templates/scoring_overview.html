{% extends "base.html" %}
{% block content %}
<h1>Park-mas Scoring Overview</h1>

<table>
  <thead>
    <tr>
      <th>Rank</th>
      <th>Operator</th>
      <th>Total Score</th>
      <th>Counted QSOs</th>
      <th>Days</th>
      <th>Parks</th>
    </tr>
  </thead>
  <tbody>
    {% for op in operators %}
    <tr>
      <td>{{ loop.index }}</td>
      <td>{{ op.operator }}</td>
      <td>{{ op.total_score }}</td>
      <td>{{ op.total_qsos }}</td>
      <td>{{ op.days }}</td>
      <td>{{ ", ".join(op.parks) }}</td>
    </tr>
    {% endfor %}
  </tbody>
</table>

<hr>

<h2>Daily breakdown</h2>
{% for op in operators %}
  <h3>{{ op.operator }}</h3>
  <ul>
  {% for (date, park_code), day in op.daily.items() %}
    <li>
      {{ date }} — {{ park_code }}:
      {{ day.score }} points,
      {{ day.qsos|length }} QSOs
      
      {% if day.is_new_park %}
        <span style="color: #28a745; font-weight: bold;">✨ NEW PARK</span>
      {% endif %}
      
      {% if day.daily_multiplier and day.daily_multiplier != 1.0 %}
        <span style="color: #dc3545; font-weight: bold;">
          ×{{ day.daily_multiplier }} BONUS
        </span>
        {% if day.daily_multiplier_reason %}
          <em>({{ day.daily_multiplier_reason }})</em>
        {% endif %}
      {% endif %}
      
      <a href="{{ url_for('main.set_daily_multiplier', operator=op.operator, date_str=date.strftime('%Y-%m-%d')) }}" 
         style="margin-left: 10px; font-size: 0.9em;">
        [{% if day.daily_multiplier and day.daily_multiplier != 1.0 %}Edit{% else %}Add{% endif %} Bonus]
      </a>
    </li>
  {% endfor %}
  </ul>
{% endfor %}

{% endblock %}